(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(e,t,n){e.exports=n(23)},20:function(e,t,n){},23:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),i=n(2),s=n.n(i);n(20),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var l=n(3),r=n(4),c=n(5),u=n(7),p=n(6),h=n(1),d=n(8),v=n(9),b=n(13),m="pencil",f=Object(l.a)({},m,function(e){var t=null,n=[],o=function(t,n,o){var a=o.x,i=o.y;e.save(),e.lineJoin="round",e.lineCap="round",e.beginPath(),e.lineWidth=t.size,e.strokeStyle=t.color,e.globalCompositeOperation="source-over",e.moveTo(n.x,n.y),e.lineTo(a,i),e.closePath(),e.stroke(),e.restore()},a=function(e,a){if(!t)return[];var i={x:e,y:a},s=t.points.slice(-1)[0];return o(t,s,i),t.points.push(i),n.push(i),[t]};return{onMouseDown:function(e,n,o,a){return[t={id:Object(b.v4)(),tool:m,color:o,size:a,points:[{x:e,y:n}]}]},onMouseMove:a,onDebouncedMouseMove:function(){var e=n;return n=[],[t,e]},onMouseUp:function(e,o){if(t){a(e,o),n=[];var i=t;return t=null,[i]}},draw:function(e,t){for(var n=0,a=0,i=e.points.length;a<i;a++)e.points[a-1]&&(t?(setTimeout(o.bind(null,e,e.points[a-1],e.points[a]),n),n+=10):o(e,e.points[a-1],e.points[a]))}}}),y=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(u.a)(this,Object(p.a)(t).call(this,e))).tool=null,n.interval=null,n.initTool=n.initTool.bind(Object(h.a)(n)),n.onMouseDown=n.onMouseDown.bind(Object(h.a)(n)),n.onMouseMove=n.onMouseMove.bind(Object(h.a)(n)),n.onDebouncedMove=n.onDebouncedMove.bind(Object(h.a)(n)),n.onMouseUp=n.onMouseUp.bind(Object(h.a)(n)),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.canvas=Object(i.findDOMNode)(this.canvasRef),this.ctx=this.canvas.getContext("2d"),this.initTool(this.props.tool)}},{key:"componentWillReceiveProps",value:function(e){var t=this,n=e.tool,o=e.items,a=e.data,i=e.currentItem;if(o.filter(function(e){return-1===t.props.items.indexOf(e)}).forEach(function(e){t.initTool(e.tool),t.tool.draw(e,t.props.animate)}),this.initTool(n),a&&a.length){var s=!0,l=!1,r=void 0;try{for(var c,u=a[Symbol.iterator]();!(s=(c=u.next()).done);s=!0){var p=c.value;this.tool.draw(p[0],this.props.animate)}}catch(h){l=!0,r=h}finally{try{s||null==u.return||u.return()}finally{if(l)throw r}}}i&&i.length&&(this.tool.draw(i[0][0],this.props.animate),this.props.resetCurrent())}},{key:"initTool",value:function(e){this.tool=this.props.toolsMap[e](this.ctx)}},{key:"onMouseDown",value:function(e){var t,n=(t=this.tool).onMouseDown.apply(t,Object(v.a)(this.getCursorPosition(e)).concat([this.props.color,this.props.size,this.props.fillColor]));n&&n[0]&&this.props.onItemStart&&this.props.onItemStart.apply(null,n),this.props.onDebouncedItemChange&&(this.interval=setInterval(this.onDebouncedMove,this.props.debounceTime))}},{key:"onDebouncedMove",value:function(){"function"==typeof this.tool.onDebouncedMouseMove&&this.props.onDebouncedItemChange&&this.props.onDebouncedItemChange.apply(null,this.tool.onDebouncedMouseMove())}},{key:"onMouseMove",value:function(e){var t,n=(t=this.tool).onMouseMove.apply(t,Object(v.a)(this.getCursorPosition(e)));n&&n[0]&&this.props.onEveryItemChange&&this.props.onEveryItemChange.apply(null,n)}},{key:"onMouseUp",value:function(e){var t,n=(t=this.tool).onMouseUp.apply(t,Object(v.a)(this.getCursorPosition(e)));n&&n[0]&&this.props.onCompleteItem&&this.props.onCompleteItem.apply(null,n),this.props.onDebouncedItemChange&&(clearInterval(this.interval),this.interval=null),this.props.onNewClickHandler(this.props.current,n)}},{key:"getCursorPosition",value:function(e){var t=this.canvas.getBoundingClientRect(),n=t.top,o=t.left;return[e.clientX-o,e.clientY-n]}},{key:"render",value:function(){var e=this,t=this.props,n=t.width,o=t.height,i=t.canvasClassName;return a.a.createElement("canvas",{ref:function(t){e.canvasRef=t},className:i,onMouseDown:this.onMouseDown,onMouseMove:this.onMouseMove,onMouseOut:this.onMouseUp,onMouseUp:this.onMouseUp,width:n,height:o})}}]),t}(o.Component);function g(e){return o.createElement("button",{type:"button",className:e.type,disabled:!e.isEnable,onClick:function(){return e.onClickHandlker()}},e.value)}y.defaultProps={width:500,height:500,color:"green",size:5,fillColor:"",canvasClassName:"canvas",debounceTime:1e3,animate:!0,tool:m,toolsMap:f,data:[]};var k=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(u.a)(this,Object(p.a)(t).call(this,e))).onNewClickHandler=function(e,t){console.log("D",e,t);var o=n.state.data,a=e+1;t?(o.push(t),n.setState({clicks:a,data:o,enableUndo:!0})):n.setState({clicks:a})},n.resetCurrent=function(){console.log("reseting"),n.setState({currentItem:[],enableUndo:!1})},n.state={tool:m,size:2,color:"green",fill:!1,fillColor:"#FFF",items:[],clicks:0,total:0,data:[],currentItem:{},enableUndo:!1},n.saveHandler=n.saveHandler.bind(Object(h.a)(n)),n.undoLastDrawing=n.undoLastDrawing.bind(Object(h.a)(n)),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=JSON.parse(localStorage.getItem("history")),t=localStorage.getItem("total");e&&e.length&&this.setState({total:t||0,data:e}),this.setState({total:t||0})}},{key:"saveHandler",value:function(e){localStorage.setItem("total",parseInt(this.state.clicks,10)),localStorage.setItem("history",JSON.stringify(this.state.data)),this.setState({total:parseInt(this.state.clicks,10)})}},{key:"undoLastDrawing",value:function(e){var t=this.state.data.slice(-1);t[0][0].color="white",t[0][0].size=6,this.setState({currentItem:t})}},{key:"render",value:function(){var e=this,t=this.state,n=t.tool,o=t.size,i=t.color,s=t.items,r=t.clicks,c=t.data,u=t.currentItem,p=t.enableUndo;return a.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},a.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"stretch"}},a.a.createElement("div",{style:{flexGrow:1}},a.a.createElement("label",null,"Pencil color:"),a.a.createElement(g,{isEnable:!0,type:"btn btn-success button",value:"\xa0",onClickHandlker:function(t){return e.setState({color:"green"})}}),a.a.createElement(g,{isEnable:!0,type:"btn btn-danger button",value:"\xa0",onClickHandlker:function(t){return e.setState({color:"red"})}}),a.a.createElement(g,{isEnable:!0,type:"btn btn-dark button",value:"\xa0",onClickHandlker:function(t){return e.setState({color:"black"})}}),a.a.createElement(g,Object(l.a)({isEnable:!0,type:"btn btn-outline-success button",value:"Undo last click",onClickHandlker:this.undoLastDrawing},"isEnable",p)),a.a.createElement(g,{isEnable:!0,type:"btn btn-outline-success button",value:"save",onClickHandlker:this.saveHandler})),a.a.createElement("div",{style:{flexGrow:8}},a.a.createElement("div",null,a.a.createElement("label",null,"click total:"),parseInt(this.state.total,10)),a.a.createElement("div",null,a.a.createElement("label",null,"clicks this session:"),this.state.clicks))),a.a.createElement("div",{style:{float:"left",marginRight:20,border:"1px solid #d3d3d3"}},a.a.createElement(y,{width:1400,height:500,size:o,color:i,items:s,tool:n,current:r,onNewClickHandler:this.onNewClickHandler,data:c,currentItem:u,resetCurrent:this.resetCurrent})))}}]),t}(o.Component);s.a.render(a.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[14,1,2]]]);
//# sourceMappingURL=main.93f416fd.chunk.js.map